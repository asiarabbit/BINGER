// input.C -- include by check.cxx assignment of the pih holes' position array

// MWDC Array L //
// DC 0
// A0
Ai[0][0][0][0] = 353.; // x
Ai[0][0][0][1] = 375.; // y
Ai[0][0][0][2] = -60.; // z
// A1
Ai[0][0][1][0] = 135.; // x
Ai[0][0][1][1] = 375.; // y
Ai[0][0][1][2] = -60.; // z
// A2
Ai[0][0][2][0] = -135.; // x
Ai[0][0][2][1] = 375.; // y
Ai[0][0][2][2] = -60.; // z
// A3
Ai[0][0][3][0] = -353.; // x
Ai[0][0][3][1] = 375.; // y
Ai[0][0][3][2] = -60.; // z
// B0
Bi[0][0][0][0] = 353.; // x
Bi[0][0][0][1] = -375.; // y
Bi[0][0][0][2] = -60.; // z
// B1
Bi[0][0][1][0] = 135.; // x
Bi[0][0][1][1] = -375.; // y
Bi[0][0][1][2] = -60.; // z
// B2
Bi[0][0][2][0] = -135.; // x
Bi[0][0][2][1] = -375.; // y
Bi[0][0][2][2] = -60.; // z
// B3
Bi[0][0][3][0] = -353.; // x
Bi[0][0][3][1] = -375.; // y
Bi[0][0][3][2] = -60.; // z
// DC 1
// A0
Ai[0][1][0][0] = 353.; // x
Ai[0][1][0][1] = 375.; // y
Ai[0][1][0][2] = -60.; // z
// A1
Ai[0][1][1][0] = 135.; // x
Ai[0][1][1][1] = 375.; // y
Ai[0][1][1][2] = -60.; // z
// A2
Ai[0][1][2][0] = -135.; // x
Ai[0][1][2][1] = 375.; // y
Ai[0][1][2][2] = -60.; // z
// A3
Ai[0][1][3][0] = -353.; // x
Ai[0][1][3][1] = 375.; // y
Ai[0][1][3][2] = -60.; // z
// B0
Bi[0][1][0][0] = 353.; // x
Bi[0][1][0][1] = -375.; // y
Bi[0][1][0][2] = -60.; // z
// B1
Bi[0][1][1][0] = 135.; // x
Bi[0][1][1][1] = -375.; // y
Bi[0][1][1][2] = -60.; // z
// B2
Bi[0][1][2][0] = -135.; // x
Bi[0][1][2][1] = -375.; // y
Bi[0][1][2][2] = -60.; // z
// B3
Bi[0][1][3][0] = -353.; // x
Bi[0][1][3][1] = -375.; // y
Bi[0][1][3][2] = -60.; // z
// DC 2
// A0
Ai[0][2][0][0] = 458.; // x
Ai[0][2][0][1] = 325.; // y
Ai[0][2][0][2] = -60.; // z
// A1
Ai[0][2][1][0] = 99.; // x
Ai[0][2][1][1] = 325.; // y
Ai[0][2][1][2] = -60.; // z
// A2
Ai[0][2][2][0] = -99.; // x
Ai[0][2][2][1] = 325.; // y
Ai[0][2][2][2] = -60.; // z
// A3
Ai[0][2][3][0] = -458.; // x
Ai[0][2][3][1] = 325.; // y
Ai[0][2][3][2] = -60.; // z
// B0
Bi[0][2][0][0] = 458.; // x
Bi[0][2][0][1] = -325.; // y
Bi[0][2][0][2] = -60.; // z
// B1
Bi[0][2][1][0] = 99.; // x
Bi[0][2][1][1] = -325.; // y
Bi[0][2][1][2] = -60.; // z
// B2
Bi[0][2][2][0] = -99.; // x
Bi[0][2][2][1] = -325.; // y
Bi[0][2][2][2] = -60.; // z
// B3
Bi[0][2][3][0] = -458.; // x
Bi[0][2][3][1] = -325.; // y
Bi[0][2][3][2] = -60.; // z
// TOFWall
// L Up
TOFWi[0][0][0][0] = -625.; // x
TOFWi[0][0][0][1] = 0.; // y, dummy
TOFWi[0][0][0][2] = 0.; // z
// L Down
TOFWi[0][0][1][0] = -625.; // x
TOFWi[0][0][1][1] = 0.; // y, dummy
TOFWi[0][0][1][2] = 0.; // z
// R Up
TOFWi[0][1][0][0] = 625.; // x
TOFWi[0][1][0][1] = 0.; // y, dummy
TOFWi[0][1][0][2] = 0.; // z
// R Down
TOFWi[0][1][1][0] = 625.; // x
TOFWi[0][1][1][1] = 0.; // y, dummy
TOFWi[0][1][1][2] = 0.; // z

// MWDC Array R //
// DC 0
// A0
Ai[1][0][0][0] = 353.; // x
Ai[1][0][0][1] = 375.; // y
Ai[1][0][0][2] = -60.; // z
// A1
Ai[1][0][1][0] = 135.; // x
Ai[1][0][1][1] = 375.; // y
Ai[1][0][1][2] = -60.; // z
// A2
Ai[1][0][2][0] = -135.; // x
Ai[1][0][2][1] = 375.; // y
Ai[1][0][2][2] = -60.; // z
// A3
Ai[1][0][3][0] = -353.; // x
Ai[1][0][3][1] = 375.; // y
Ai[1][0][3][2] = -60.; // z
// B0
Bi[1][0][0][0] = 353.; // x
Bi[1][0][0][1] = -375.; // y
Bi[1][0][0][2] = -60.; // z
// B1
Bi[1][0][1][0] = 135.; // x
Bi[1][0][1][1] = -375.; // y
Bi[1][0][1][2] = -60.; // z
// B2
Bi[1][0][2][0] = -135.; // x
Bi[1][0][2][1] = -375.; // y
Bi[1][0][2][2] = -60.; // z
// B3
Bi[1][0][3][0] = -353.; // x
Bi[1][0][3][1] = -375.; // y
Bi[1][0][3][2] = -60.; // z
// DC 1
// A0
Ai[1][1][0][0] = 353.; // x
Ai[1][1][0][1] = 375.; // y
Ai[1][1][0][2] = -60.; // z
// A1
Ai[1][1][1][0] = 135.; // x
Ai[1][1][1][1] = 375.; // y
Ai[1][1][1][2] = -60.; // z
// A2
Ai[1][1][2][0] = -135.; // x
Ai[1][1][2][1] = 375.; // y
Ai[1][1][2][2] = -60.; // z
// A3
Ai[1][1][3][0] = -353.; // x
Ai[1][1][3][1] = 375.; // y
Ai[1][1][3][2] = -60.; // z
// B0
Bi[1][1][0][0] = 353.; // x
Bi[1][1][0][1] = -375.; // y
Bi[1][1][0][2] = -60.; // z
// B1
Bi[1][1][1][0] = 135.; // x
Bi[1][1][1][1] = -375.; // y
Bi[1][1][1][2] = -60.; // z
// B2
Bi[1][1][2][0] = -135.; // x
Bi[1][1][2][1] = -375.; // y
Bi[1][1][2][2] = -60.; // z
// B3
Bi[1][1][3][0] = -353.; // x
Bi[1][1][3][1] = -375.; // y
Bi[1][1][3][2] = -60.; // z
// DC 2
// A0
Ai[1][2][0][0] = 353.; // x
Ai[1][2][0][1] = 375.; // y
Ai[1][2][0][2] = -60.; // z
// A1
Ai[1][2][1][0] = 135.; // x
Ai[1][2][1][1] = 375.; // y
Ai[1][2][1][2] = -60.; // z
// A2
Ai[1][2][2][0] = -135.; // x
Ai[1][2][2][1] = 375.; // y
Ai[1][2][2][2] = -60.; // z
// A3
Ai[1][2][3][0] = -353.; // x
Ai[1][2][3][1] = 375.; // y
Ai[1][2][3][2] = -60.; // z
// B0
Bi[1][2][0][0] = 353.; // x
Bi[1][2][0][1] = -375.; // y
Bi[1][2][0][2] = -60.; // z
// B1
Bi[1][2][1][0] = 135.; // x
Bi[1][2][1][1] = -375.; // y
Bi[1][2][1][2] = -60.; // z
// B2
Bi[1][2][2][0] = -135.; // x
Bi[1][2][2][1] = -375.; // y
Bi[1][2][2][2] = -60.; // z
// B3
Bi[1][2][3][0] = -353.; // x
Bi[1][2][3][1] = -375.; // y
Bi[1][2][3][2] = -60.; // z
// TOFWall
// L Up
TOFWi[1][0][0][0] = -625.; // x
TOFWi[1][0][0][1] = 0.; // y, dummy
TOFWi[1][0][0][2] = 0.; // z
// L Down
TOFWi[1][0][1][0] = -625.; // x
TOFWi[1][0][1][1] = 0.; // y, dummy
TOFWi[1][0][1][2] = 0.; // z
// R Up
TOFWi[1][1][0][0] = 625.; // x
TOFWi[1][1][0][1] = 0.; // y, dummy
TOFWi[1][1][0][2] = 0.; // z
// R Down
TOFWi[1][1][1][0] = 625.; // x
TOFWi[1][1][1][1] = 0.; // y, dummy
TOFWi[1][1][1][2] = 0.; // z


// further processing //
// assign Aif and Bif
memcpy(Aif, Ai, sizeof(Aif));
memcpy(Bif, Bi, sizeof(Bif));
// take into account the laser ball cushion thickness
double blipB = 60./130.*dcThickness-60., blipF = 70./130.*dcThickness-70.;
//cout << "blipB: " << blipB << "\tblipF: " << blipF << endl; getchar(); // DEBUG
for(int i = 2; i--;){
	for(int j = 3; j--;) for(int k = 4; k--;){
		if(0. != Ai[i][j][k][2]){
			Ai[i][j][k][2] -= blipB;
			Ai[i][j][k][2] -= (offsetT + offsetGap)*cos(skewAng);
			Ai[i][j][k][1] -= (offsetT + offsetGap)*sin(skewAng);
		}
		if(0. != Bi[i][j][k][2]){
			Bi[i][j][k][2] -= blipB;
			Bi[i][j][k][2] -= (offsetT + offsetGap)*cos(skewAng);
			Bi[i][j][k][1] -= (offsetT + offsetGap)*sin(skewAng);
		}
		if(0. != Aif[i][j][k][2]){
			Aif[i][j][k][2] += 130. + blipF;
			Aif[i][j][k][2] += (offsetT + offsetGap)*cos(skewAng);
			Aif[i][j][k][1] -= (offsetT + offsetGap)*sin(skewAng);
		}
		if(0. != Bif[i][j][k][2]){
			Bif[i][j][k][2] += 130. + blipF;
			Bif[i][j][k][2] += (offsetT + offsetGap)*cos(skewAng);
			Bif[i][j][k][1] -= (offsetT + offsetGap)*sin(skewAng);
		}
	} // end for over k
	for(int j = 2; j--;) for(int k = 2; k--;){
		if(0. != TOFWi[i][j][k][2]) TOFWi[i][j][k][2] -= offsetT;
	} // end for over j, k (L-R, U-D)
} // end for over i (DCArr)

// take into the aluminum plate width
// MWDC Array L //
// DC 0
double dAlP = offsetAld - offsetGap;
//cout << "dAlP*sin(skewAng): " << dAlP*sin(skewAng) << endl; getchar(); // DEBUG
Ai[0][0][0][2] -= dAlP*cos(skewAng); Ai[0][0][0][1] -= dAlP*sin(skewAng); // A0
Ai[0][0][2][2] -= dAlP*cos(skewAng); Ai[0][0][2][1] -= dAlP*sin(skewAng); // A2
Ai[0][0][3][2] -= dAlP*cos(skewAng); Ai[0][0][3][1] -= dAlP*sin(skewAng); // A3
Aif[0][0][2][2] += dAlP*cos(skewAng); Aif[0][0][2][1] -= dAlP*sin(skewAng); // Af2
// DC 1
Ai[0][1][0][2] -= dAlP*cos(skewAng); Ai[0][1][0][1] -= dAlP*sin(skewAng); // A0
Ai[0][1][2][2] -= dAlP*cos(skewAng); Ai[0][1][2][1] -= dAlP*sin(skewAng); // A2
Ai[0][1][3][2] -= dAlP*cos(skewAng); Ai[0][1][3][1] -= dAlP*sin(skewAng); // A3
Aif[0][1][2][2] += dAlP*cos(skewAng); Aif[0][1][2][1] -= dAlP*sin(skewAng); // Af2
Aif[0][1][3][2] += dAlP*cos(skewAng); Aif[0][1][3][1] -= dAlP*sin(skewAng); // Af3
// DC 2
// MWDC Array R //
// DC 0
// DC 1
Ai[1][1][0][2] -= dAlP*cos(skewAng); Ai[1][1][0][1] -= dAlP*sin(skewAng); // A0
Ai[1][1][1][2] -= dAlP*cos(skewAng); Ai[1][1][1][1] -= dAlP*sin(skewAng); // A1
Ai[1][1][2][2] -= dAlP*cos(skewAng); Ai[1][1][2][1] -= dAlP*sin(skewAng); // A2
// DC 2
Ai[1][2][0][2] -= dAlP*cos(skewAng); Ai[1][2][0][1] -= dAlP*sin(skewAng); // A0
Ai[1][2][1][2] -= dAlP*cos(skewAng); Ai[1][2][1][1] -= dAlP*sin(skewAng); // A1
Ai[1][2][2][2] -= dAlP*cos(skewAng); Ai[1][2][2][1] -= dAlP*sin(skewAng); // A2
Ai[1][2][3][2] -= dAlP*cos(skewAng); Ai[1][2][3][1] -= dAlP*sin(skewAng); // A3
Bi[1][2][2][2] -= dAlP*cos(skewAng); Bi[1][2][2][1] -= dAlP*sin(skewAng); // B2




















